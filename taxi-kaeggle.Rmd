---
title: "Kaeggle - Taxi"
output: html_notebook
---

Bibliotecas

```{r}
library(readr)
library(lubridate)
library(geosphere)
```


Dados:

```{r, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# train = read_csv("train.zip")
# test = read_csv("test.zip")

load("train")
load("test")

```


Separando data por mes, dia e hora (todos registros são de 2016)

```{r}
train$Month <- month(train$pickup_datetime)
train$Day <- day(train$pickup_datetime)
train$Hour <- hour(train$pickup_datetime)
train$Minute <- minute(train$pickup_datetime)
train$Weekday <- weekdays(train$pickup_datetime)
```

Distancia entre as coordenadas (Rodar uma única vez)

```{r}
# # Distance <- distm(train[,c("pickup_longitude", "pickup_latitude")], train[,c("dropoff_longitude", "dropoff_latitude")], fun = distHaversine)
# # Distance <- as.matrix(Distance)
# # train$Distance <- Distance[row(Distance) == col(Distance)] # aborta sessão R
# 
# for(i in 122428:nrow(train)) {
#   print(i)
#   train$Distance[i] <- distm(train[i,c("pickup_longitude", "pickup_latitude")], train[i,c("dropoff_longitude", "dropoff_latitude")], fun = distHaversine)
# }
# 
# # Novo dataset agora com a variável Distance
# save(train, file = "train")
# 
# test$Distance <- NA
# 
# for(i in 1:nrow(test)) {
#   print(i)
#   test$Distance[i] <- distm(test[i,c("pickup_longitude", "pickup_latitude")], test[i,c("dropoff_longitude", "dropoff_latitude")], fun = distHaversine)
# }
# 
# # Novo dataset agora com a variável Distance
# save(test, file = "test")


```


```{r}
head(train)
```

```{r}
test$Month <- month(test$pickup_datetime)
test$Day <- day(test$pickup_datetime)
test$Hour <- hour(test$pickup_datetime)
test$Minute <- minute(test$pickup_datetime)
test$Weekday <- weekdays(test$pickup_datetime)
```

```{r}
formula <- trip_duration ~ Month +
  Day +
  Hour +
  Minute +
  Weekday +
  vendor_id +
  passenger_count +
  pickup_longitude +
  pickup_latitude + 
  dropoff_longitude +
  dropoff_latitude + 
  store_and_fwd_flag
```


```{r}
lm <- lm()
```

